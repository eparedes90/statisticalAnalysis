type = "Chow",
point = 10)
sctest(formula = volCobre_var ~ pbiChina_var + precioCobre_var + tipoCambio_var + ied_var,
type = "Chow",
point = 10)
sctest(m7,
type = "Chow",
point = 10)
#Morosidad según tipo y modalidad de crédito de las Cajas Municipales
#Credito pequeñas empresas
#prestamos
#creditos a microempresas
#prestamos
rm(list = ls())
library(readxl)
library(dplyr)
library(tidyr)
library(stringr)
library(tseries)
library(ggplot2)
library(forecast)
library(fpp2)
theme_set(theme_classic())
#set directory
setwd("E:/Asesorías de tesis/Administración/Morosidad Cajas Financieras/raw/C-1242-/")
basedir <- getwd()
months <- list.files(basedir, full.names = F, recursive = F)
length(months)
months[1]
cajas <- c("Concepto",
"CMAC Arequipa",
"CMAC Cusco",
"CMAC Huancayo",
"CMAC Piura")
for (i in 1:length(months)){
data <- read_xls(months[i])
data <- data[c(4, 35, 39, 45, 49), ]
colnames(data) <- data[1, ]
data <- data[-1, ]
data[2, 1] <- "PréstamosPeq"
data[4, 1] <- "PréstamosMicro"
data <- data[, cajas]
period <- unlist(strsplit(months[i], split = "_"))
data$year <- period[1]
data$mes <- period[2]
if (i == 1){
moro1 <- data
} else {moro1  <- rbind(moro1, data)
}
}
peq <- moro1[moro1$Concepto == "PréstamosPeq", -1]
peq$mes <- gsub(peq$mes, pattern = ".xls", replacement = "")
peq$mes <- as.numeric(peq$mes)
peq$year <- as.numeric(peq$year)
peq <- peq[order(peq$year, peq$mes), ]
peq[, ] <- apply(peq[,], 2, function(x) as.numeric(x))
peqTs <- ts(peq[, c(1:4)], start = c(2016, 1), frequency = 12)
autoplot(peqTs)
##
micro <- moro1[moro1$Concepto == "PréstamosMicro", -1]
micro$mes <- gsub(micro$mes, pattern = ".xls", replacement = "")
micro$mes <- as.numeric(micro$mes)
micro$year <- as.numeric(micro$year)
micro <- micro[order(micro$year, micro$mes), ]
micro[, ] <- apply(micro[,], 2, function(x) as.numeric(x))
microTs <- ts(micro[, 1:4], frequency = 12, start = c(2016, 1))
microTs
autoplot(microTs)
autoplot(peqTs)
View(moro1)
theme_set(theme_bw())
autoplot(microTs)
theme_set(theme_dark())
autoplot(microTs)
theme_set(theme_grey())
autoplot(microTs)
theme_set(theme_gray())
autoplot(microTs)
theme_set(theme_bw())
autoplot(microTs)
theme_set(theme_bw())
?date()
date(micro$year, micro$mes)
?as.date
?as.date()
?as.date
?as.Date
micro$date <- paste(micro$year, micro$mes, sep = "-")
micro$date <- paste(micro$year, micro$mes, sep = "-")
micro$date <- as.Date(micro$date, "%y-%m")
View(micro)
micro$date <- paste(micro$year, micro$mes, sep = "-")
micro$date <- as.Date(micro$date, "%yyyy-%mm")
micro$date <- paste(micro$year, micro$mes, sep = "-")
micro$date <- as.Date(micro$date, "%yyyy-%mm")
View(micro)
micro$date <- as.Date(micro$date, "%y-%m")
micro$date <- as.Date(micro$date, format = "%Y-%m")
View(micro)
micro$date <- paste(micro$year, micro$mes, sep = "-")
micro$date <- paste(micro$mes, micro$year, sep = "-")
micro$date <- as.Date(micro$date, format = "%m-%Y")
micro$date <- paste(micro$mes, micro$year, sep = "-")
class(micro$date)
micro$date <- as.Date.character(micro$date, format = "%m-%Y")
autoplot(microTs, facets = TRUE)
a <- as.Date("2016-1")
a <- as.Date("2016-01")
a <- as.Date("2016-01", format = "%Y-%m")
a
a <- as.Date("2016-1", format = "%yyyy-%m")
a
a <- as.Date("2016-01", format = "%yyyy-%mm")
a
a <- as.Date(x = "2016-01", format = "%yyyy-%mm")
a
a <- as.Date(x = "2016-01", format = "%Y-%m")
a
peqTs <- ts(peq[peq$year == 2019 |
peq$year == 2020|
peq$year ==2021, c(1:4)], start = c(2016, 1), frequency = 12)
autoplot(peqTs)
peqTs <- ts(peq[peq$year == 2019 |
peq$year == 2020|
peq$year ==2021, c(1:4)], start = c(2019, 1), frequency = 12)
autoplot(peqTs)
peqTs <- ts(peq[peq$year == 2019 |
peq$year == 2020|
peqTs                  peq$year ==2021, c(1:4)], start = c(2019, 1), frequency = 12)
peqTs
# ggplot(micro, aes(micro$date)) +
#   geom_line(aes(color = variable), size = 1)
microTs <- ts(micro[micro$year == 2019|
micro$year == 2020|
micro$year == 2021, 1:4], frequency = 12, start = c(2019, 1))
microTs
autoplot(microTs, facets = TRUE)
autoplot(microTs)
#Morosidad según tipo y modalidad de crédito de las Cajas Municipales
#Credito pequeñas empresas
#prestamos
#creditos a microempresas
#prestamos
rm(list = ls())
library(readxl)
library(dplyr)
library(tidyr)
library(stringr)
library(tseries)
library(ggplot2)
library(forecast)
library(fpp2)
theme_set(theme_bw())
#set directory
setwd("E:/Asesorías de tesis/Administración/Morosidad Cajas Financieras/raw/C-1230-/")
basedir <- getwd()
months <- list.files(basedir, full.names = F, recursive = F)
length(months)
months[1]
cajas <- c("Concepto",
"CMAC Arequipa",
"CMAC Cusco",
"CMAC Huancayo",
"CMAC Piura")
data <- read_xls(months[1])
View(data)
colnames(data) <- data[3, ]
cajas <- c("CMAC Arequipa",
"CMAC Cusco",
"CMAC Huancayo",
"CMAC Piura")
data <- data[3, c(1, 6)]
colnames(data) <- data[3, ]
data <- read_xls(months[1])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
data <- data[cajas, ]
data <- read_xls(months[1])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
data <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp <- data
} else {
temp <- rbind(temp, data)
}
}
View(temp)
length(cajas)
cajas[1]
cajas[2]
View(data)
data <- read_xls(months[1])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
data <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp <- data
} else {
temp <- rbind(temp, data)
}
}
View(temp)
data <- read_xls(months[1])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, data)
}
}
View(temp2)
#prestamos
#creditos a microempresas
#prestamos
rm(list = ls())
library(readxl)
library(dplyr)
library(tidyr)
library(stringr)
library(tseries)
library(ggplot2)
library(forecast)
library(fpp2)
theme_set(theme_bw())
#set directory
setwd("E:/Asesorías de tesis/Administración/Morosidad Cajas Financieras/raw/C-1230-/")
basedir <- getwd()
months <- list.files(basedir, full.names = F, recursive = F)
length(months)
months[1]
cajas <- c("CMAC Arequipa",
"CMAC Cusco",
"CMAC Huancayo",
"CMAC Piura")
data <- read_xls(months[1])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, temp1)
}
}
View(temp2)
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas = cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, temp1)
}
}
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, temp1)
}
}
View(temp1)
View(temp2)
temp2 <- temp2[!is.na(temp2$Empresas), ]
data[data$Empresas == cajas[1], ]
for (n in 1:length(months)){
data <- read_xls(months[n])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, temp1)
}
}
temp2 <- temp2[!is.na(temp2$Empresas), ]
if (n == 1){
temp3 <- temp2
} else {
temp3 <- rbind(temp3, temp2)
}
}
View(temp3)
for (n in 1:length(months)){
data <- read_xls(months[n])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, temp1)
}
}
temp2 <- temp2[!is.na(temp2$Empresas), ]
period <- unlist(strsplit(months[i], split = "_"))
temp2$year <- period[1]
temp2$mes <- period[2]
temp2$mes <- gsub(temp2$mes, pattern = ".xls", replacement = "")
if (n == 1){
temp3 <- temp2
} else {
temp3 <- rbind(temp3, temp2)
}
}
View(temp3)
for (n in 1:length(months)){
data <- read_xls(months[n])
data <- data[, c(1, 6)]
colnames(data) <- data[3, ]
for (i in 1:length(cajas)){
temp1 <- data[data$Empresas == cajas[i], ]
if (i == 1){
temp2 <- temp1
} else {
temp2 <- rbind(temp2, temp1)
}
}
temp2 <- temp2[!is.na(temp2$Empresas), ]
period <- unlist(strsplit(months[n], split = "_"))
temp2$year <- period[1]
temp2$mes <- period[2]
temp2$mes <- gsub(temp2$mes, pattern = ".xls", replacement = "")
if (n == 1){
temp3 <- temp2
} else {
temp3 <- rbind(temp3, temp2)
}
}
View(temp3)
wide <- pivot_wider(temp3, names_from = Empresas, values_from = temp3$`Morosidad según criterio contable SBS2/`)
wide <- pivot_wider(temp3, names_from = temp3$Empresas, values_from = temp3$`Morosidad según criterio contable SBS2/`)
?pivot_wider
wide <- pivot_wider(temp3, names_from = Empresas, values_from = `Morosidad según criterio contable SBS2/`)
View(wide)
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, ],
start = c(2019, 1),
frequency = 12)
autoplot(wide)
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, c(2:6)],
start = c(2019, 1),
frequency = 12)
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, c(2:6)],
start = c(2019, 1),
frequency = 12)
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, 2:6],
start = c(2019, 1),
frequency = 12)
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, 2:6],
start = c(2019, 1),
frequency = 12)
#temp 3 = long! (this is for ggplot2)
wide <- pivot_wider(temp3, names_from = Empresas, values_from = `Morosidad según criterio contable SBS2/`)
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, 2:6],
start = c(2019, 1),
frequency = 12)
wide[, ] <- apply(wide[, ], 2, function(x) as.numeric(x))
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, 2:6],
start = c(2019, 1),
frequency = 12)
#temp 3 = long! (this is for ggplot2)
wide <- pivot_wider(temp3, names_from = Empresas, values_from = `Morosidad según criterio contable SBS2/`)
wide[, ] <- apply(wide[, ], 2, function(x) as.numeric(x))
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, 2:6],
start = c(2019, 1),
frequency = 12)
autoplot(wide)
#temp 3 = long! (this is for ggplot2)
wide <- pivot_wider(temp3, names_from = Empresas, values_from = `Morosidad según criterio contable SBS2/`)
wide[, ] <- apply(wide[, ], 2, function(x) as.numeric(x))
wide <- ts(wide[wide$year == 2019|
wide$year == 2020|
wide$year == 2021, 3:6],
start = c(2019, 1),
frequency = 12)
autoplot(wide)
#temp 3 = long! (this is for ggplot2)
MorosidadSBS <- pivot_wider(temp3, names_from = Empresas, values_from = `Morosidad según criterio contable SBS2/`)
MorosidadSBS[, ] <- apply(MorosidadSBS[, ], 2, function(x) as.numeric(x))
MorosidadSBS <- ts(MorosidadSBS[MorosidadSBS$year == 2019|
MorosidadSBS$year == 2020|
MorosidadSBS$year == 2021, 3:6],
start = c(2019, 1),
frequency = 12)
autoplot(MorosidadSBS)
autoplot(MorosidadSBS)
#Morosidad según tipo y modalidad de crédito de las Cajas Municipales
#Credito pequeñas empresas
#prestamos
#creditos a microempresas
#prestamos
rm(list = ls())
library(readxl)
library(dplyr)
library(tidyr)
library(stringr)
library(tseries)
library(ggplot2)
library(forecast)
library(fpp2)
theme_set(theme_bw())
#set directory
setwd("E:/Asesorías de tesis/Administración/Morosidad Cajas Financieras/raw/C-1216-/")
basedir <- getwd()
months <- list.files(basedir, full.names = F, recursive = F)
length(months)
months[1]
temp <- read_xlsx(months[1])
length(months)
temp <- read_xlsx(months[1])
temp <- read_xlsx(months[1])
temp <- read_xls(months[1])
View(temp)
temp <- temp[, c(1, 2,3,5,9)]
View(temp)
colnames(temp) <- temp[5, ]
temp <- temp[27, ]
period <- unlist(strsplit(months[1], split = "_"))
temp$year <- period[1]
temp$mes <- period[2]
temp$mes <- gsub(temp$mes, pattern = ".xls", replacement = "")
for (i in 1:length(months)){
temp <- read_xls(months[i])
temp <- temp[, c(1, 2,3,5,9)]
colnames(temp) <- temp[5, ]
temp <- temp[27, ]
period <- unlist(strsplit(months[1], split = "_"))
temp$year <- period[1]
temp$mes <- period[2]
temp$mes <- gsub(temp$mes, pattern = ".xls", replacement = "")
if (i == 1){
temp2 <- temp
} else {
temp2 <- rbind(temp2, temp)
}
}
months[16]
months[17]
months[16]
months[15]
View(temp2)
for (i in 1:length(months)){
temp <- read_xls(months[i])
temp <- temp[, c(1, 2, 3, 5, 9)]
colnames(temp) <- temp[5, ]
temp <- temp[27, ]
period <- unlist(strsplit(months[i], split = "_"))
temp$year <- period[1]
temp$mes <- period[2]
temp$mes <- gsub(temp$mes, pattern = ".xls", replacement = "")
if (i == 1){
temp2 <- temp
} else {
temp2 <- rbind(temp2, temp)
}
}
View(temp2)
months[15]
months[16]
for (i in 1:length(months)){
temp <- read_xls(months[i])
temp <- temp[, c(1, 2, 3, 5, 9)]
colnames(temp) <- temp[5, ]
temp <- temp[27, ]
period <- unlist(strsplit(months[i], split = "_"))
temp$year <- period[1]
temp$mes <- period[2]
temp$mes <- gsub(temp$mes, pattern = ".xls", replacement = "")
if (i == 1){
temp2 <- temp
} else {
temp2 <- rbind(temp2, temp)
}
}
View(temp2)
CreditosDirectos <- ts(temp2[temp2$year == 2019|
temp2$year == 2020|
temp2$year == 2021, ],
start = c(2019, 1),
frequency = 12)
CreditosDirectos <- ts(temp2[temp2$year == 2019|
temp2$year == 2020|
temp2$year == 2021, 2:5],
start = c(2019, 1),
frequency = 12)
autoplot(CreditosDirectos)
